<!DOCTYPE html>
<html lang="en-us"><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="generator" content="Hugo 0.110.0">
	
	<title>Blazor Game Development - part 2 | Coding with Hans</title>
	
	

	<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://henthoven.github.io/codingwithhans.net/blog/20210711-blazor-game-development-2/cover.png"/>
<meta name="twitter:title" content="Blazor Game Development - part 2"/>
<meta name="twitter:description" content="During these summer days I thought it would be nice to do a bit of fun programming beside my normal programming job. When thinking about this I realized that during my study time I once developed a side scrolling platform game in C&#43;&#43;."/>

	<meta property="og:title" content="Blazor Game Development - part 2" />
<meta property="og:description" content="During these summer days I thought it would be nice to do a bit of fun programming beside my normal programming job. When thinking about this I realized that during my study time I once developed a side scrolling platform game in C&#43;&#43;." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://henthoven.github.io/codingwithhans.net/blog/20210711-blazor-game-development-2/" /><meta property="og:image" content="https://henthoven.github.io/codingwithhans.net/blog/20210711-blazor-game-development-2/cover.png"/><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2021-07-09T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-07-09T00:00:00+00:00" />


	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">

	
	<link rel="stylesheet" href="https://henthoven.github.io/codingwithhans.net/css/medium.5d8b1ab8b08a901e050e2b50bb701cf46024c6770e6b9ba2ed37c1c41b080adf.css"> 

	
	<link rel="stylesheet" href="https://henthoven.github.io/codingwithhans.net/css/additional.d7ce26e054a52def87f9b29b7b8eacb2a6e55755720063de89a1a440f0aa22e5.css"> 

	
	
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="https://henthoven.github.io/codingwithhans.net//">

            
            <span style="font-family:Righteous;">Coding with Hans</span><span class="site-extention">.NET</span>
            <div class="page-sub-title">Everyting about software development using .NET and C#!</div>
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                 
                    
                    <li class="nav-item ">
                        <a class="nav-link" href="/codingwithhans.net/">Home</a>
                    </li>
                    
                 
                    
                    <li class="nav-item ">
                        <a class="nav-link" href="/codingwithhans.net/blog">Blogs</a>
                    </li>
                    
                 
                    
                    <li class="nav-item ">
                        <a class="nav-link" href="/codingwithhans.net/about">About</a>
                    </li>
                    
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="mainheading">
    <h1 class="sitetitle">Coding with Hans</h1>
    <p class="lead">
         Everyting about software development using .NET and C#!
    </p>
</div><div class="main-content">
        
        <div class="container">
            <div class="row">
                                
                <div class="col-md-9 flex-first flex-md-unordered">
                    <div class="mainheading">
                        	
                        
                        
                        
                        <div class="row post-top-meta">
                            <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0 md-nopad-right">
                                <img class="author-thumb" src="/codingwithhans.net/images/hans-thumb-small.jpg" alt="Hans Enthoven">
                            </div>
                            <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left md-nopad-left">
                                <a target="_blank" class="link-dark">Hans Enthoven</a><br>
                                <span class="author-description">
                                    Hi, my name is Hans Enthoven. The author of this blog.<br>
                                    <i class="far fa-star"></i>
                                    Jul 9, 2021
                                    <i class="far fa-clock clock"></i>
                                    5 min read
                                </span>					
                            </div>
                        </div>			
                        	
                        
                                                
                        
                        <h1 class="posttitle">Blazor Game Development - part 2</h1> 
                    </div>

                    
                    
                    
                        <img class="featured-image img-fluid" src="https://henthoven.github.io/codingwithhans.net/blog/20210711-blazor-game-development-2/cover.png" alt="thumbnail for this post">
                    
                    

                    
                    <div class="article-post">
                        <p>During these summer days I thought it would be nice to do a bit of fun programming beside my normal programming job. When thinking about this I realized that during my study time I once developed a side scrolling platform game in C++. When I build that game I did that with some libraries to handle input, graphics, sound, etc. but without a game engine. So things like collision detection, physics and scrolling of the screen where all things I had to implement by myself.</p><p>I came up with the idea to build something similar in .NET using an environment that is relatively new to me. So I decided to make a simple snake game in Blazor. This is my second blog in the series. In this blog I will talk about handling input and using sprites. If you want to start with my first blog, you can find <a href='/blog/20210630-blazor-game-development-1/'><u>part 1 here</u></a>.</p>
<h2 id="handling-input">Handling input</h2>
<p>In Blazor there are several attributes you can place on elements to handle events, for example:</p>
<ul>
<li>@onkeydown</li>
<li>@onkeyup</li>
<li>@onmousedown</li>
<li>@onmouseup</li>
</ul>
<p>On those attributes you can specify a method in your Blazor component that must be called when the event happens. This code can look like this:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;canvasContainer&#34;</span> <span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">onkeyup</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;OnKeyUp&#34;</span>&gt;
</span></span><span style="display:flex;"><span>@code {
</span></span><span style="display:flex;"><span>  private void OnKeyUp(KeyboardEventArgs args)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        Console.WriteLine($&#34;Key pressed: {args.Code}&#34;);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></p>
<p>In the example above the OnKeyUp method will be called every time a pressed key is released. From that code you can then of course implement your game logic and what needs to happen when you released a certain key.</p>
<p>There is only one more challenge here. Because the @onkeyup method is declared on a specific element this elements needs to have focus to handle the events. When this element does not have focus no events will happen and our code will not be called. In case of a game I assume you always want to have focus on the game and handle those input events. To realize this I added another small piece of javascript to my page:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>// always keep focus
</span></span><span style="display:flex;"><span>window.game.canvases[0].onblur = (e) =&gt; {
</span></span><span style="display:flex;"><span>    window.game.canvases[0].focus();
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>window.game.canvases[0].focus();</span></span></code></pre></div>
<p>Using this code I can make sure that as soon as the element loses its focus (onblur), focus is re-applied to it.</p>
<p>All the things I described above will work the same way if you want to handle mouse events. I have made some examples that can be found on:
<a href="https://github.com/henthoven/BlazorFunExamples">https://github.com/henthoven/BlazorFunExamples</a></p>
<p>Look for the project <a href="https://github.com/henthoven/BlazorFunExamples/tree/master/Example3" target="_blank" >Example3</a> to see the input handling examples.</p>
<h2 id="using-sprites">Using sprites</h2>
<p>For a game it is of course also important to have some images/sprites to show. For my game my definition of a sprite is just an image that is used to display a certain object in the game. In this chapter I will explain how you can make sprites using Piskelapp and how you can use them in a game.</p>
<h3 id="piskelapp">Piskelapp</h3>
<p>I am not a designer and I am sure there are a lot of application available to make sprites. When I was looking for a good application I had 2 requirements in mind:</p>
<ul>
<li>Support transparency</li>
<li>Support to store multiple sprites in one image</li>
</ul>
<p>The second requirement is important to me because it will help making it more efficient to load images into the game. Next to that the HTML5 canvas has very good support for drawing images to a canvas from a certain part of an image.</p>
<p>While searching I ended up with an application named <a href="https://www.piskelapp.com/">Piskelapp</a>. This is a web application that you can use with or without an account from your browser or you can download it and run it as a desktop application. I have used the web version without making an account for my examples. In Piskelapp you have a basic drawing set where you can draw your sprites and in the end save all your sprites to one image. The result can for example look as follows:</p>
<p><img src="examplesprite.png" alt="PiskelApp, example sprite"></p>
<p>In this image you see 2 sprites which are each 32 pixels wide and 32 pixels in height. To use those sprites from our Blazor application we have to load our image from the server. We do this by simply adding an image tag with the hidden attribute on it. In that way the browser will not show the image to the user. Next to that we add the @ref attribute from Blazor to it so we have a reference to it from our Blazor component. It looks as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">img</span>  <span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">ref</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;_demoSprites&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Images/BlazorFunPiskelDemo.png&#34;</span> <span style="color:#a6e22e">hidden</span>/&gt;
</span></span><span style="display:flex;"><span>@code {
</span></span><span style="display:flex;"><span>    ElementReference _demoSprites;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Now we have a reference in our Blazor component to the images with our sprites. To draw those sprites to the screen we can make use of the drawImage method of the HTML5 canvas. To this method you can pass in:</p>
<ul>
<li>the reference to our _demoSprites image</li>
<li>the source X and Y position to get the sprite from in the image</li>
<li>the source width and height of the sprite in the image</li>
<li>the target X and Y position on the canvas</li>
<li>the target width and height on the canvas</li>
</ul>
<p>To draw the second sprite of our image to the X,Y position 100,100 on the canvas the method call will look like this:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">await</span> _canvasContext.DrawImageAsync (_demoSprites, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">32</span>);</span></span></code></pre></div></p>
<p>I have made an example application using those sprites which can be found on:
<a href="https://github.com/henthoven/BlazorFunExamples">https://github.com/henthoven/BlazorFunExamples</a></p>
<p>Look for the <a href="https://github.com/henthoven/BlazorFunExamples/tree/master/Example5" target="_blank" >Example5</a> project for loading sprites from 1 image. This example also show basic movement of the sprite over the screen.</p>
<p>In <a href="/blog/20210805-blazor-game-development-3">my next blog</a> I will continue on this subject and we will talk about how we can add sound to our game and create a real snake game.</p>

                    </div>
                    
                    
                    <div class="after-post-tags">
                        <ul class="tags">
                        
                        <li>
                        <a href="/tags/blazor">blazor</a>
                        </li>
                        
                        <li>
                        <a href="/tags/dotnet">dotnet</a>
                        </li>
                        
                        <li>
                        <a href="/tags/gaming">gaming</a>
                        </li>
                        
                        </ul>
                    </div>
                    
                    
                    <div class="row">
                        
                        <div class="col-md-12"><div class="share sticky-top sticky-top-offset">
    <p>Share</p>
    <ul>
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://twitter.com/intent/tweet?text=Blazor%20Game%20Development%20-%20part%202&url=https%3a%2f%2fhenthoven.github.io%2fcodingwithhans.net%2fblog%2f20210711-blazor-game-development-2%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=435');return false;">
        <i class="fab fa-twitter"></i>
        </a>
        </li>
        
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://facebook.com/sharer.php?u=https%3a%2f%2fhenthoven.github.io%2fcodingwithhans.net%2fblog%2f20210711-blazor-game-development-2%2f" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
        <i class="fab fa-facebook-f"></i>
        </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3a%2f%2fhenthoven.github.io%2fcodingwithhans.net%2fblog%2f20210711-blazor-game-development-2%2f" onclick="window.open(this.href, 'linkedin-share', 'width=550,height=435');return false;">
            <i class="fab fa-linkedin"></i>
            </a>
        </li>
        

    </ul>

    
</div>
</div>  
                    </div>

                    
                    <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
                    
                        <a class="d-block col-md-6" href="https://henthoven.github.io/codingwithhans.net/blog/20210829-blazor-game-development-3/"> &laquo; Blazor Game Development - part 3</a>
                    
                    
                        <a class="d-block col-md-6 text-lg-right" href="https://henthoven.github.io/codingwithhans.net/blog/20210630-blazor-game-development-1/">Blazor Game Development - part 1 &raquo;</a>
                    
                    <div class="clearfix"></div>
                    </div>
                    
                </div>
                              
            </div>           
        </div>
        
        
    </div>


            </div>
<div class="jumbotron fortags">
	<div class="d-md-flex h-100">
		
		<div class="col-md-9 p-5 align-self-center text-center">
			
			<a class="mt-1 mb-1" href="/tags/blazor">blazor</a>
			
			<a class="mt-1 mb-1" href="/tags/csharp">csharp</a>
			
			<a class="mt-1 mb-1" href="/tags/dotnet">dotnet</a>
			
			<a class="mt-1 mb-1" href="/tags/dotnetcore">dotnetcore</a>
			
			<a class="mt-1 mb-1" href="/tags/gaming">gaming</a>
			
		</div>
	</div>
</div>

<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-sm-12 text-center text-lg-left">
                &copy; Copyright Hans Enthoven - All rights reserved
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                
            </div>
        </div>
    </div>
</footer>


        </div>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


<script src="https://henthoven.github.io/codingwithhans.net/js/mediumish.e4b90c58dfa15ac82caf2edfa01e5fd047e17bc15e6babe5c0e442a4407d0b25.js"></script> 
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-1XXXXXXX1-X', 'auto');
	
	ga('send', 'pageview');
}
</script>
    </body>
</html>
